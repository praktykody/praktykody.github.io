<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Pogodynka</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
	<style>
		* {
			-webkit-box-sizing: border-box;
							box-sizing: border-box;
		}

		html,
		body {
			margin: 0;
			padding: 0;
		}

		html .loader,
		body .loader {
			height: 80%;
		}

		html .mainContainer,
		body .mainContainer {
			background-color: green;
			background-image: url("/images/angular_weather_background.jpg");
			background-size: cover;
			width: 100vw;
			height: 100vh;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			-webkit-box-orient: vertical;
			-webkit-box-direction: normal;
					-ms-flex-direction: column;
							flex-direction: column;
			-webkit-box-pack: center;
					-ms-flex-pack: center;
							justify-content: center;
		}

		html .mainContainer header,
		body .mainContainer header {
			background-color: #fff;
			position: absolute;
			top: 0;
			width: 100%;
			padding: 2%;
		}

		html .mainContainer header h1, html .mainContainer header h6,
		body .mainContainer header h1,
		body .mainContainer header h6 {
			margin: 0;
			text-align: center;
		}

		html .mainContainer .cities,
		body .mainContainer .cities {
			width: 30%;
			position: absolute;
			top: 0;
			background-color: #fff;
		}

		html .mainContainer .cities input[type=text],
		body .mainContainer .cities input[type=text] {
			width: 100%;
		}

		html .mainContainer .cities ul,
		body .mainContainer .cities ul {
			display: none;
			margin: 0;
			padding: 0;
			position: relative;
			z-index: 1;
			background-color: #fff;
			max-height: 50vh;
			overflow-y: auto;
		}

		html .mainContainer .cities ul li,
		body .mainContainer .cities ul li {
			border: 1px dashed #000;
			padding: 1%;
			list-style-type: none;
			cursor: pointer;
		}

		html .mainContainer .cities ul li:hover,
		body .mainContainer .cities ul li:hover {
			background-color: #cccccc;
		}

		html .mainContainer .showWth,
		body .mainContainer .showWth {
			background-color: #e6e6e6;
			width: 50%;
			margin-left: 25%;
			text-align: center;
			padding: 2%;
			position: relative;
		}

		html .mainContainer .showWth .displayDay,
		body .mainContainer .showWth .displayDay {
			border: 1px dashed #000;
		}

		html .mainContainer .showWth .displayDay h2,
		body .mainContainer .showWth .displayDay h2 {
			margin: 0;
		}

		html .mainContainer .showWth .displayDay img,
		body .mainContainer .showWth .displayDay img {
			width: 20%;
		}

		html .mainContainer .showWth .displayDay .group,
		body .mainContainer .showWth .displayDay .group {
			border-top: 1px dashed #000;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			-webkit-box-pack: space-evenly;
					-ms-flex-pack: space-evenly;
							justify-content: space-evenly;
		}

		html .mainContainer .showWth .disableView,
		body .mainContainer .showWth .disableView {
			background-color: #e6e6e6;
			position: absolute;
			width: 100%;
			height: 100%;
			top: 0;
			left: 0;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			-webkit-box-align: center;
					-ms-flex-align: center;
							align-items: center;
			-webkit-box-pack: center;
					-ms-flex-pack: center;
							justify-content: center;
		}

		html .mainContainer .showWth .otherDays,
		body .mainContainer .showWth .otherDays {
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
		}

		html .mainContainer .showWth .otherDays .singleDay,
		body .mainContainer .showWth .otherDays .singleDay {
			cursor: pointer;
			padding: 2%;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			-webkit-box-orient: vertical;
			-webkit-box-direction: normal;
					-ms-flex-direction: column;
							flex-direction: column;
			-webkit-box-pack: center;
					-ms-flex-pack: center;
							justify-content: center;
			-webkit-box-align: center;
					-ms-flex-align: center;
							align-items: center;
			border: 1px dashed #000;
			border-top: none;
			border-left: none;
		}

		html .mainContainer .showWth .otherDays .singleDay:nth-child(1),
		body .mainContainer .showWth .otherDays .singleDay:nth-child(1) {
			border-left: 1px dashed #000;
		}

		html .mainContainer .showWth .otherDays .singleDay img,
		body .mainContainer .showWth .otherDays .singleDay img {
			width: 80%;
		}

		html .mainContainer .showWth .otherDays .singleDay h4,
		body .mainContainer .showWth .otherDays .singleDay h4 {
			margin: 0;
		}

		@media only screen and (max-width: 600px) {
			.showWth {
				width: 100% !important;
				margin-left: 0 !important;
			}
		}
	</style>

	<style>
		.cities .search{
			/* border:2px dashed red; */
			display:flex;
		}
		.sunInfo{
			display: flex;
		}
		.list{
			border:2px dashed red;
			display:flex;
			overflow-x: scroll;
		}
		.list > div {
			border:2px dashed blue;
		}


	</style>
</head>
<body data-ng-app="myApp">
	<div class='mainContainer' data-ng-controller="weather">
		<header>
			<h1>POGODA</h1>
			<p>Powered by 
				<a href="https://openweathermap.org/" target="_blank">openweathermap.org</a>
			</p>
		</header>
		<nav class="cities">
			<div class="search">
				<!-- <input type="text" data-ng-model="searchCity" data-ng-change="getCities(searchCity)" placeholder="Szukaj" />  -->
				<input type="text" data-ng-model="searchCity" placeholder="Szukaj" /> 
				<button data-ng-click="getCities(searchCity)"> Search </button>     
			</div>
			<!-- <ul class="searchList">
				<li data-ng-repeat="c in cities" data-ng-click="getWeather(c.woeid,c.title)">
					{{c.title}}
				</li>
			</ul> -->
			<!-- <h2>{{ city.name }}</h2> -->
		</nav>
		<main class="showWth">
			<div class="displayDay">	
				<!-- <h2>{{weather.title}}</h2> -->
				<h2>{{ weather.city.name }}</h2>
				<div class="sunInfo">
					<p>
						SUNRISE {{ weather.city.sunrise }}
					</p>
					<p>
						SUNSET {{ weather.city.sunset }}
						<!-- SUNSET {{ new Date(weather.city.sunset).toLocaleString }} -->
					</p>
				</div>
				<div class="list">
					<div data-ng-repeat="l in weather.list">
						<div>{{ l.dt_txt }}</div>
						<div>{{ l.main.feels_like }}</div>
						<div>{{ l.main.temp }}</div>
						<div>{{ l.weather.icon }}</div>
						<!-- <div>{{ l.main. }}</div> -->
						<!-- {{ l.dt }} -->
					</div>
				</div>
				<!-- DAY: {{ day[currDay] }} -->
				<!--
				<div>{{day[currDay].applicable_date}}</div>
				-->
				<!-- <img src="https://www.metaweather.com/static/img/weather/{{day[currDay].weather_state_abbr}}.svg" /> -->
				<!-- <div class="group">
					<div>{{day[currDay].the_temp| number:1}}°C</div>
					<div>{{day[currDay].main.temp| number:1}}°C</div>
					<div>{{day[currDay].air_pressure}} hPa</div>
				</div>
				<div class="group">
					<div>{{day[currDay].max_temp|number:2}}°C</div>
					<div>{{day[currDay].min_temp|number:2}}°C</div>
					<div>{{day[currDay].predictability}}%</div>
				</div>
				<div class="group">
					<div>{{day[currDay].wind_direction|number:2}}</div>
					<div>{{day[currDay].wind_direction_compass}}</div>			
					<div>{{day[currDay].wind_speed|number:2}} mph</div>
				</div>
			</div> -->
			<!-- <div class="otherDays">
				<div class="singleDay" data-ng-repeat="d in day" data-ng-click="$parent.currDay = $index">
						<img src="https://www.metaweather.com/static/img/weather/{{d.weather_state_abbr}}.svg" />
						<h4>{{d.the_temp| number:0}}°C</h4>     
						<h4>{{d.temp| number:0}}°C</h4>     
				</div>
			</div> -->
			<div class="disableView">Wybierz miasto.</div>
		</main>
	</div>
<script>
const app = angular.module("myApp", []);
var sl = document.querySelector(".searchList");
var dV = document.querySelector(".disableView");
app.controller('weather', function($scope, $http, $filter){    
	$scope.getCities = function(str){
		console.log({ str })
		sl.style.display = "block";
		// $http.get("http://api.openweathermap.org/geo/1.0/direct?&appid={API key}&q=Katowice")
		// .then(function(response){
			const response = { data: [{ "name": "Katowice", "lat": 50.2598987, "lon": 19.0215852, "country": "PL" }] }
			console.log({ response })
			$scope.cities = response.data;
		// })

	}
	$scope.getWeather = function(id,city){
		$scope.searchCity = city;
		// sl.style.display = "none";
		dV.style.display = "flex";

		dV.innerHTML = `
		<svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
			width="40px" height="40px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">
			<path fill="#000" d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z">
				<animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"/>
			</path>
		</svg>`;

		// $http.get("https://api.openweathermap.org/data/2.5/forecast?lat=50.2598987&lon=19.0215852&appid={API key}")
		// .then(function(response){
		const response = {
			data : {
				"cod": "200",
				"message": 0,
				"cnt": 40,
				"list": [
					{
						"dt": 1679011200,
						"main": {
							"temp": 272.73,
							"feels_like": 270.35,
							"temp_min": 272.73,
							"temp_max": 274.44,
							"pressure": 1025,
							"sea_level": 1025,
							"grnd_level": 992,
							"humidity": 76,
							"temp_kf": -1.71
						},
						"weather": [
							{
								"id": 800,
								"main": "Clear",
								"description": "clear sky",
								"icon": "01n"
							}
						],
						"clouds": {
							"all": 9
						},
						"wind": {
							"speed": 1.89,
							"deg": 137,
							"gust": 2.99
						},
						"visibility": 10000,
						"pop": 0,
						"sys": {
							"pod": "n"
						},
						"dt_txt": "2023-03-17 00:00:00"
					},
					{
						"dt": 1679022000,
						"main": {
							"temp": 273.26,
							"feels_like": 270.49,
							"temp_min": 273.26,
							"temp_max": 273.95,
							"pressure": 1025,
							"sea_level": 1025,
							"grnd_level": 991,
							"humidity": 69,
							"temp_kf": -0.69
						},
						"weather": [
							{
								"id": 802,
								"main": "Clouds",
								"description": "scattered clouds",
								"icon": "03n"
							}
						],
						"clouds": {
							"all": 41
						},
						"wind": {
							"speed": 2.28,
							"deg": 131,
							"gust": 4.66
						},
						"visibility": 10000,
						"pop": 0,
						"sys": {
							"pod": "n"
						},
						"dt_txt": "2023-03-17 03:00:00"
					},
					{
					"dt": 1679032800,
					"main": {
						"temp": 274.39,
						"feels_like": 272.04,
						"temp_min": 274.39,
						"temp_max": 274.39,
						"pressure": 1025,
						"sea_level": 1025,
						"grnd_level": 992,
						"humidity": 60,
						"temp_kf": 0
					},
					"weather": [
						{
							"id": 803,
							"main": "Clouds",
							"description": "broken clouds",
							"icon": "04d"
						}
					],
					"clouds": {
						"all": 60
					},
					"wind": {
						"speed": 2.08,
						"deg": 137,
						"gust": 4.95
					},
					"visibility": 10000,
					"pop": 0,
					"sys": {
						"pod": "d"
					},
					"dt_txt": "2023-03-17 06:00:00"
					},
				],
				"city": {
					"id": 3096472,
					"name": "Katowice",
					"coord": {
					"lat": 50.2599,
					"lon": 19.0216
				},
				"country": "PL",
				"population": 317316,
				"timezone": 3600,
				"sunrise": 1678942596,
				"sunset": 1678985332
				}
			}
		}
		dV.style.display = "none";
		$scope.weather = response.data;
		console.log('scope: ', $scope.weather)
		// let day = response.data.consolidated_weather;
		// let day = response.data.list;
		// $scope.day = day;
		$scope.day = response.data.list;
		$scope.currDay = 0;
	// });


	}
	$scope.getWeather(1,'Katowice')
});
</script>
</body>
</html>